---
layout: post
title: About testcase
---

TDD의 은총을 받아온 TDD 빠돌이로써 테스트케이스에 대해서 한 번쯤 정리해보고 싶었다.



테스트에 대한 간략한 정의가 필요 (유닛테스트, 통합테스트, 스모크 테스트 등)

왜 테스트를 싫어할까?

​	TDD는 죽었다. 관련 얘기.

​	테스트 환경을 만드는데 걸리는 시간과 코드를 작성하는데 걸리는 시간의 문제.

​	QA 자체를 독립적인 팀이 수행한다는 마인드

TDD 는 왜 필요한가?

​	테스트 자동화, Regression 테스트를 위한 심리적 위안. 나는 이게 가장 크다고 본다.

​	유닛테스트라고 부를 수 있을지 모르겠지만, 내가 생각하는 단위의 통합테스트의 경우 해당 테스트케이스 자체가 문서화를 일정부분 대체한다.

​	사용자 측면에서 내가 만든 코드를 바라보게 해 줌으로써 모듈의 디자인 측면에서 잘못된/부족한 부분들을 개발단계에서 많이 발견하게 해준다.

​	빠르게 disposable 한 코드를 작성할 때 매우 편리하다.

​	반복을 제거해준다.

TDD 개념을 좀 더 크게 적용하기

​	목표 달성과정 : 비전 수립 > 장기 목표 > 단기 목표 > 소화하기 편한 작은 업무로 쪼게기 > 해결

​	개발은 특히 과정 자체가 bottom-up 스타일이기 때문에 맥락을 잃어버리는 경우가 많이 있는 것 같다. 특히 하나의 어려운 문제에 매몰될 수록..

​	TDD 역시 마찬가지 어프로치가 가능하다. 하나의 피쳐 구현을 가정해보자. 기획 확인 > 요구사항 수립 > 필요한 요구사항들을 테스트케이스에 문장으로 적음 > [사용자] 입장에서 시나리오를 기술 > 구현!

​	버그 수정도 마찬가지이다. 버그 발생 > 여러가지 방법을 사용하여 문제 원인 확인 > 재현 시퀀스 확인 > 재현 시퀀스를 테스트케이스로 작성 > 수정. (물론 모든 버그가 이렇게 수정가능하지는 않지만..)

테스트 환경 자체를 발전시켜 나가기

​	prepareTestUsers() 같이 쉽게 환경을 셋업할 수 있는 라이브러리들을 추가해 나가는게 좋다. 점점 더 추상화된 레벨에서 테스트를 기술할 수 있게 되며, 뒤로 갈수록 점점 더 개발속도가 빨라진다.

테스트를 할 때 가장 중요하게 고려해야 하는 것들

​	앞서 이야기한 것처럼 테스팅을 위한 라이브러리들이 추가되어 가는게 좋다. 테스트에 필요한 boilerplate 코드들을 최대한 제거하는 것이 쾌적한 TDD를 위한 선결조건이다.

​	Dependency Injection 개념을 잘 고민해서 넣어야 한다. Mocking 을 잘하는 것이 중요한 경우가 많다.

​	처음부터 너무 완벽하고자 하지 않는게 좋다. 특히 익숙하지 않은 경우에는 말이다.

클라이언트 앱에서의 테스팅

​	이게 가장 어려운 부분이고, 나도 끊임없이 고민하고 있는 부분이다. 하지만 가장 중요한 것은 로직과 UI를 최대한 완전히 분리할 수 있도록 만드는 것이 핵심이고 이게 좋은 디자인이기도 하다. 따라서 최근? 유행하는 reactive style (flux?) 의 ui 는 TDD와 무척이나 궁합이 잘 맞는다.

​	현재 내 입장에서 UI 자체에 대한 테스트는 두 가지 방법 중 하나를 택한다. 아예 버리거나… 완전히 Event-Driven 형태로 작성하여 독자적으로 테스팅하는 것이다. 자동화하기는 아직까지는 쉽지 않다. 그러나 불가능한 이야기도 아니다. 다만, 비용이 많이 들기 때문에 거대 조직이 아니라면 안하는게 좋다고 본다. 그러나 특정 시나리오에 대해서 UI가 flux 스타일로 구현되어 있다면, 분명 가능하긴 하다. 하지만 상당히 challenging 할 것이다.



대략 내용들

- 테스트케이스는 죽었다는 도발을 켄트백이 받아줘서.. 듣고 싶은 얘기를 해주는 사람에게 사기치기 좋다. 테스트케이스는 죽었다는 얘기는 테스트케이스를 싫어하는 사람들이 듣고 싶어하던 얘기이다.

  다만, 그럼에도 불구하고 테스트케이스에 뭔가 불편한 면이 있기 때문에 사람들이 싫어하는 것이고 그걸 들어볼 가치는 충분하다.

- 진정한 초반 프로토타이핑에는 안해도 좋겠지만, 해당 프레임워크 등에 어느정도 기술적인 자신감이 있다면 오히려 tdd 어프로치가 빠르다.

- 테스트케이스를 일종의 시나리오 테스트로 사용하는 것을 고려해보자. debug 를 이용해서 같이 처리하면 거의 문서화에 가깝다.

- 심지어 TDD보다 나아가서 누군가는 DDD(Document-Driven Development) 이야기를 한 적도 있고, 아마존인가에서는 Marketing 용어부터 만든다는 이야기도 있었다.

- 테스트케이스 : 로직을 seperation 해서 처리할 수 있도록 해준다. 서버의 경우는 순수 로직이기 때문에 tdd를 구현하기가 참 쉬운데, 클라의 경우에는 쉽지 않은 것이 사실이다. 일반적으로 ui를 먼저 구성하고 로직을 구성하게 되는 경우가 꽤 많기 때문이다. 하지만 이건 결국 설계에 미진한 부분이 있다고 볼 수도 있다.

- 특히 로직과 UI가 잘 분리되고 나면 react.js와 같은 functional approach에서 엄청난 이득을 얻게 된다.

- 생각해보면 나는 unit-testing 보다는 integration testing에 가까운 것을 하고 있는거 같기도 하다. 별로 상관은 없는데, 이건 좀 명확하게 고민할 필요가 있는 듯 하다. 좀 더 거시적인 측면으로 테스팅할 수 있어야 의미가 있는것 아닌가? 짧은 코드들을 갖고 몇 개 안되는 걸 테스트해봤자 의미가 있나 싶어서 이런 경우에는 integration 테스트를 이용한다. (기획 점검 => 테스트케이스 작성 => 코드 작성으로 이어지는 내 방식에 대해서 적어볼 필요도 있어 보임.)

- 테스트케이스가 왜 이상하게 느껴지는가? 생각을 top-down 에서 하다가 어느순간 bottom-up 으로 들어가는 순간이 많다. 이건 코딩을 하는데 어쩔 수 없는 부분이다.  하지만 top-down으로 breakdown 하는데 있어서 test-case는 매우 도움이 된다.

- 특히 strongly-typed 언어를 쓰지 않는 경우 테스트케이스는 더욱 중요하다. 거의 필수적이라 본다. 하지만, 그만큼 strong-typed 언어를 사용한다고 해서, 컴파일이 되는 것을 테스트케이스를 만족하는 것처럼 착각하게 만드는 안좋은 효과도 크다.

- ​

  ​